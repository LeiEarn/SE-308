---
layout: default
title: 软件设计文档
---

# 软件设计文档
{:.no_toc}

* 目录
{:toc}

## 1. Client

### 1.1 用户端

#### 1.1.1 技术选型及理由

**微信小程序框架**

我们选择了微信小程序开发框架作为用户端的前端框架。

* 小程序在视图层与逻辑层间提供了数据传输和事件系统，让开发者能够专注于数据与逻辑。
* 框架的核心是一个响应的数据绑定系统，可以让数据与视图非常简单地保持同步。当做数据修改的时候，只需要在逻辑层修改数据，视图层就会做相应的更新。
* 框架管理了整个小程序的页面路由，可以做到页面间的无缝切换，并给以页面完整的生命周期。
* 框架提供基础的组件和丰富的微信原生 API。通过框架，可以直接使用自带微信风格样式的组件进行页面设计，还可以方便的调起微信提供的能力，因此可以通过简单、高效的方式让开发者可以在微信中开发具有原生 APP 体验的服务。
* 微信小程序的普及可以推动挣闲钱系统的推行，并且对于用户也更加快捷和便利。

基于以上理由，选择微信小程序作为圈地框架对用户和开发者都十分友好。

#### 1.1.2 架构设计

**WePY小程序组件化开发框架**

WePY 是一款让小程序支持组件化开发的框架，通过预编译的手段让开发者可以选择自己喜欢的开发风格去开发小程序。WePY 框架在开发过程中参考了 Vue 等现有框架的一些语法风格和功能特性，对原生小程序的开发模式进行了再次封装，更贴近于 MVVM 架构模式, 并支持ES6/7的一些新特性。

特性：

* 开发风格：接近于 Vue.js，支持组件 Props 传值，自定义事件、组件分布式复用Mixin、计算属性函数。computed、模板内容分发slot等等
* 组件化：组件化开发，完美解决组件隔离，组件嵌套，组件通信等问题。
* NPM：支持使用第三方 npm 资源，自动处理 npm 资源之间的依赖关系，完美兼容所有无平台依赖的 npm 资源包。
* Promise：通过 polyfill 让小程序完美支持 Promise，解决回调烦恼。
* 优化：对小程序本身的优化，如请求列对处理，优雅的事件处理，生命周期的补充，性能的优化等等。

#### 1.1.3 模块划分

根据业务逻辑和用例图，将挣闲钱用户端分成以下模块：

* 用户
    1. 用户授权登录获取信息
    2. 修改个人信息
    3. 身份实名认证
    4. 账户余额充值。
* 任务
    1. 获取当前任务列表
    2. 获取用户自己发布的任务列表
    3. 获取用户自己接受的任务列表
    4. 获取任务详情
    5. 用户发布、中止、接受、放弃、完成任务。

页面渲染、路由控制等操作都由微信小程序框架完成，采用组件化开发的思想，将每个页面抽象为一个组件，页面中也可以包括子组件。

* 系统的每个界面可能会使用到公共的资源，如公共组件、工具函数等等，将这些部分分别抽离成components、lib、style等子包；
* assets触发静态资源，如图片、图标等。

最后用户端的结构如下：

```
.
├── package.json                    # 项目总体信息，依赖列表
├── package-lock.json               # 依赖 lock
├── project.config.json             # 小程序部分设置项
├── README.md                       # 介绍页
├── src                             # 小程序源代码部分
│   ├── app.wpy                     # 小程序入口
│   ├── assets                      # 静态资源
│   │   └── ...
│   ├── components                  # 复用组件
│   │   └── ...
│   ├── lib                         # 杂项库
│   │   ├── cookieJar.js            # cookie库
│   │   └──  request.js             # 网络请求库
│   ├── style                       # wxss 全局变量
│   │   ├── iconfont.wxss           # iconfont 资源
│   │   └── weui.wxss               # weui 样式库
│   ├── mixins                      # 混合组件
│   │   └── ...
│   └── pages                       # 小程序页面
│       ├── index.wpy               # 主页
│       ├── issue.wpy               # 任务发布页面
│       ├── authorize.wpy               # 授权页面
│       ├── search.wpy               # 搜索页面
│       ├── about.wpy               # 小程序关于页面
│       ├── user                    # 用户
│       │   ├── mine.wpy            # 我的 页面
│       │   ├── info.wpy            # 信息修改 页面
│       │   ├── auth.wpy            # 身份认证 页面
│       │   ├── balance.wpy            # 余额 页面
│       │   ├── team.wpy            # 组织 页面
│       │   ├── teamdetail.wpy            # 组织详情 页面
│       │   └── setting.wpy            # 设置 页面
│       ├── task                    # task
│       │   ├── task.wpy            # 任务 页面
│       │   ├── published.wpy          # 我的已发布任务 页面
│       │   ├── accepted.wpy        # 我的已接受任务 页面
│       │   ├── accepter.wpy        # 任务的接收者 页面
│       │   └── detail.wpy          # 任务 页面
│       └── publish                # 发布
│           ├── publish.wpy             # 发布 页面
│           ├── normaltask.wpy             # 普通任务发布 页面
│           └── wjx.wpy             # 问卷星发布 页面
└── wepy.config.js                  # wepy 构建配置
```

### 1.2 管理员端

## 2. Server